function NavModule(window, document) {

var globs = null
var self = this

var states = []

// Autogenerated with DRAKON Editor 1.33


function PushStateMachine_Go_go(self, state) {
    self.state = "Go";
}

function PushStateMachine_Go_nav(self, state) {
    self.state = "Nav";
}

function PushStateMachine_Go_push(self, state) {
    setPageId(self, state)
    self.state = "Go";
}

function PushStateMachine_Init_default(self, state) {
    self.state = "Init";
}

function PushStateMachine_Init_push(self, state) {
    self.pageId = 1
    setPageId(self, state)
    self.state = "Go";
}

function PushStateMachine_Nav_go(self, state) {
    self.state = "Go";
}

function PushStateMachine_Nav_nav(self, state) {
    self.state = "Nav";
}

function PushStateMachine_Nav_push(self, state) {
    console.log("nav")
    self.state = "Go";
}

function fireCallback(data, onCompleted) {
    if (self.stateCallback) {
        self.stateCallback(
            data,
            onCompleted
        )
    }
}

function onStateChange(evt) {
    var onCompleted, state
    state = evt.state
    globs.nav()
    if (state.data) {
        globs.pageId = state.pageId
        onCompleted = function() {
            globs.go()
        }
        fireCallback(
            state.data,
            onCompleted
        )
    } else {
        if (state.pageId > globs.pageId) {
            window.history.forward()
        } else {
            if (state.pageId < globs.pageId) {
                window.history.back()
            }
        }
        globs.go()
    }
}

function pushState(data, title, url) {
    var state
    state = {
        data : data,
        title : title,
        url : url
    }
    globs.push(state)
}

function setPageId(self, state) {
    state.pageId = self.pageId
    self.pageId++
}

function PushStateMachine() {
  var _self = this;
  _self.type_name = "PushStateMachine";
  _self.state = "Init";
  _self.go = function(state) {
    var _state_ = _self.state;
    if (_state_ == "Init") {
      return PushStateMachine_Init_default(_self, state);
    }
    else if (_state_ == "Go") {
      return PushStateMachine_Go_go(_self, state);
    }
    else if (_state_ == "Nav") {
      return PushStateMachine_Nav_go(_self, state);
    }
    return null;
  };
  _self.nav = function(state) {
    var _state_ = _self.state;
    if (_state_ == "Init") {
      return PushStateMachine_Init_default(_self, state);
    }
    else if (_state_ == "Go") {
      return PushStateMachine_Go_nav(_self, state);
    }
    else if (_state_ == "Nav") {
      return PushStateMachine_Nav_nav(_self, state);
    }
    return null;
  };
  _self.push = function(state) {
    var _state_ = _self.state;
    if (_state_ == "Init") {
      return PushStateMachine_Init_push(_self, state);
    }
    else if (_state_ == "Go") {
      return PushStateMachine_Go_push(_self, state);
    }
    else if (_state_ == "Nav") {
      return PushStateMachine_Nav_push(_self, state);
    }
    return null;
  };
}


globs = new PushStateMachine()


this.onStateChange = onStateChange
this.pushState = pushState


}

var Nav = new NavModule(window, document)
